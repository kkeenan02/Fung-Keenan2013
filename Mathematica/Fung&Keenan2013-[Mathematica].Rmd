<center>
Fung & Keenan 2013: Description of Mathematica programs used to calculate  confidence intervals
========================================================

Tak Fung^1,2 and Kevin Keenan^3
----------------------------------------------------

<h6>

<sup>1</sup> National University of Singapore, Department of Biological Sciences, 14 Science Drive 4, Singapore 117543

<sup>2</sup> Queen’s University Belfast, School of Biological Sciences, Belfast BT9 7BL, UK

<sup>3</sup> Queen’s University Belfast, Institute for Global Food Security, School of Biological Sciences, Belfast BT9 7BL, UK

</center>
</h6>

### Introduction
This document describes the functionality of the Mathematica code used in Fung & Keenan 2013. The code was written and tested using _Mathematica_ v5.0[1]. This document describes four seperate programs named, `pmfSamplingDistYiN`, `AcceptanceRegion`, `CIforpiCasePiiUnknown` and `CIforpiCasePiiknown`. This document has also been reproduced for users of the statistical programming environment, `R`, where all code examples have been converted to `R` code. A copy of the `R` version of this document can be found at: https://github.com/kkeenan02/Fung-Keenan2013 in the R folder.

#### `pmfSamplingDistYiN`
This program returns $P(Y_{i,N} = y_{i,N})$ as specified by equation (9) in the main text, give $M$, $N$, $p_{i}$, $P_{ii}$ and $y_{i,n}$. Here, $Y_{i,N}$ is the random variable specifying the number of copies of allele $A_{i}$ in a sample of size $N$ taken from a finite diploid population of size $M$, with the frequency of allele $A_{i}$ in the population being $p_{i}$ and the frequency of homozygotes of allele $A_{i}$ in the population being $P_{ii}$.

##### `pmfSamplingDistYiN` source code (_Mathematica_)
```
(* M is the population size;
  NN is the sample size;
  
  pi is the frequency of allele Ai in the population;
  Pii is the frequency of homozygotes with allele Ai in the population;
  yiN is a particular value of the number of copies of allele Ai in the sample *)
pmfSamplingDistYiN[M_, NN_, pi_, Pii_, yiN _]:=
  
Module[{Maxfunc, Minfunc, Lowerbound, Upperbound, Numerator1, Summand, Prob, xii},
    
    

  (* The lower and upper bounds for xii are specified according to equation (8) *)
    
  Maxfunc = Max[(yiN/2) - (M*pi) + (M*Pii), yiN - NN, 0];
    
  Minfunc = Min[M*Pii, yiN/2, M - NN + yiN - (2*M*pi) + (M*Pii)];
    
  Lowerbound = Ceiling[Maxfunc];
    
  Upperbound = Floor[Minfunc];
    

  (* P(YiN = yiN) is calculated according to equation (9) *)
    
  (* First, numerator is computed. *)
    
  Numerator1 = 0.0;
    
  For[xii = Lowerbound, xii ≤ Upperbound, xii++,
      
    Summand = Binomial[M*Pii, xii]*Binomial[2*M*(pi - Pii), yiN - (2*xii)]*Binomial[M + (M*Pii) -  
      (2*M*pi), NN + xii - yiN];
      
    Numerator1 = Numerator1 + Summand;
      
  ];
    
  (* Second, numerator is divided by denominator *)
    
  Prob = Numerator1/Binomial[M, NN];
    
  Return[Prob];
    
    
];
```

##### `pmfSamplingDistYiN` example
```
(* Example Run and Output *)
pmfSamplingDistYiN[1000, 10, 0.1, 0.04, 1] // Timing
{0.005244 Second, 0.250394}
```
